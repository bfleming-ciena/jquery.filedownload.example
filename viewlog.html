<html>
  <head>
    <title>S3 POST Form</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="http://localhost/jquery-1.10.2.js"></script>
    <script src="http://localhost/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.js"></script>
    <script src="http://localhost/jquery.fileDownload.js"></script>
    <link rel="stylesheet" type="text/css" href="ui-lightness/jquery-ui-1.10.3.custom.css">

 <style type="text/css">


  </head>


<script type="text/javascript">

    $(document).ready( function() {
      var url = 'log.txt';
      $('#log').load(url);
    });


$(document).on("click", "a.fileDownloadRichUI", function () {

  url = 'http://localhost/server.py';
  var $preparingFileModal = $("#preparing-file-modal");
  $preparingFileModal.dialog({ modal: true });

  $.fileDownload(url, {
     successCallback: function(url) {
         $preparingFileModal.dialog('close');
     },
     failCallback: function(responseHtml, url) {
         $preparingFileModal.dialog('close');
         $("#error-modal").dialog({ modal: true });
     }
  });

return false; //this is critical to stop the click event which will trigger a normal file download!
});

</script>

<body>
Log Content
<hr>
<div id='log'></div>
<hr>


<a class="fileDownloadRichUI" HREF="http://localhost/server.py">Click to Download</a>
<!-- <button onclick="download()">Download</button>
 -->

<div id="preparing-file-modal" title="Download in Progress" style="display: none;">
    Please wait...
<!--Throw what you'd like for a progress indicator below-->
</div>

<div id="error-modal" title="Error" style="display: none;">
    There was a problem generating your report, please try again.
</div>
</body>
</html>

